import * as types from './action-types';
import axios from 'axios'

let token = document.getElementsByName('csrf-token')[0].getAttribute('content')
axios.defaults.headers.common['X-CSRF-Token'] = token
axios.defaults.headers.common['Accept'] = 'application/json'

export function getCategories() {
  return dispatch => {
    dispatch(getCategoryRequest())
    return axios.get('/category')
      .then(response => dispatch(getCategorySuccess(response.data)))
      .catch(errors => dispatch(getCategoryFailure( ex.response.data)))
  }
}

export function createCategory(data) {
  return dispatch => {
    dispatch(getCategoryRequest())
    return axios.post('/category', data, { headers: { 'X-CSRF-Token': 'lololololo' } })
      .then(response => dispatch(getCategorySuccess(response.data)))
      .catch(errors => dispatch(getCategoryFailure( ex.response.data)))
  }
}

export const getCategoryRequest = () => ({ type: types.RECEIVE_USER_REQUEST })
export const getCategorySuccess = category => ({ type: types.RECEIVE_USER_SUCCESS, category })
export const getCategoryFailure = errors => ({ type: types.RECEIVE_USER_FAILURE, errors })
